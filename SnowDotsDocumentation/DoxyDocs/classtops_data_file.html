<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MasterScan: topsDataFile Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="topsHTMLStylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MasterScan
   &#160;<span id="projectnumber">Lab_Matlab_control Master Branch</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="classtops_data_file-members.html">List of all members</a> &#124;
<a href="#pub-attribs">Properties and Events</a> &#124;
<a href="#pub-static-methods">Static Methods</a> &#124;
<a href="#pri-methods">Private Methods</a>  </div>
  <div class="headertitle">
<div class="title">topsDataFile Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Overview</h2>
<div class="textblock"><p>Utility to organize incremental reading and writing of data. </p>
<p><a class="el" href="classtops_data_file.html" title="Utility to organize incremental reading and writing of data.">topsDataFile</a> facilitates writing data to a single file, incrementally, over time. It keeps track of data increments themeselves as well as metadata related to which increments have already been written. It also facilitates reading incremental data and keeps track of which increments have already been read out.</p>
<p><a class="el" href="classtops_data_file.html" title="Utility to organize incremental reading and writing of data.">topsDataFile</a> is suitable for sharing data (such as <a class="el" href="classtops_data_log.html" title="One central place to log data on the fly.">topsDataLog</a> data) between separate instance of Matlab running on the same machine. Each Matlab instance should be able to write data increments and read in increments that were written by the other. <a class="el" href="classtops_data_file.html" title="Utility to organize incremental reading and writing of data.">topsDataFile</a> attempts to prevent data corruption due to poorly timed access by saving data and metadata separately, and using metadata to coordinate file access.</p>
<p>Note that <a class="el" href="classtops_data_file.html" title="Utility to organize incremental reading and writing of data.">topsDataFile</a> objects are not handle objects, and <a class="el" href="classtops_data_file.html" title="Utility to organize incremental reading and writing of data.">topsDataFile</a> objects themselves are not returned directly. Instead, the <a class="el" href="classtops_data_file.html#a932f7761ec6c24ffbfa78c05ce94bfba" title="Create a header struct with fields that match the properties of the topsDataFile class.">newHeader()</a> methods returns a struct with fields that match the properties of the <a class="el" href="classtops_data_file.html" title="Utility to organize incremental reading and writing of data.">topsDataFile</a> class, and other <a class="el" href="classtops_data_file.html" title="Utility to organize incremental reading and writing of data.">topsDataFile</a> methods expect to work with these "header" structs. This pattern faciliitates writing and reading of header meta data to file. It also makes explicit the idea that <a class="el" href="classtops_data_file.html" title="Utility to organize incremental reading and writing of data.">topsDataFile</a> objects represent data on the hard disk, and should not themselves contain much data or maintain much internal state. </p>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Properties and Events</h2></td></tr>
<tr class="memitem:a11ae7a55494110f02f037320d01bc800"><td class="memItemLeft" align="right" valign="top"><a id="a11ae7a55494110f02f037320d01bc800"></a>
Property&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtops_data_file.html#a11ae7a55494110f02f037320d01bc800">fileWithPath</a> = 'topsDataFileData.mat'</td></tr>
<tr class="memdesc:a11ae7a55494110f02f037320d01bc800"><td class="mdescLeft">&#160;</td><td class="mdescRight">string name of the file to read from and write to, which may include the file path <br /></td></tr>
<tr class="separator:a11ae7a55494110f02f037320d01bc800"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7fd106e26fd84e47086a33115eaeac4d"><td class="memItemLeft" align="right" valign="top"><a id="a7fd106e26fd84e47086a33115eaeac4d"></a>
Property&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtops_data_file.html#a7fd106e26fd84e47086a33115eaeac4d">incrementPrefix</a> = 'topsDataFileIncrement'</td></tr>
<tr class="memdesc:a7fd106e26fd84e47086a33115eaeac4d"><td class="mdescLeft">&#160;</td><td class="mdescRight">string prefix to use for identifying data increments <br /></td></tr>
<tr class="separator:a7fd106e26fd84e47086a33115eaeac4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0d4db102f0f75fa28303e4701c493c2"><td class="memItemLeft" align="right" valign="top"><a id="ae0d4db102f0f75fa28303e4701c493c2"></a>
Property&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtops_data_file.html#ae0d4db102f0f75fa28303e4701c493c2">dateTimeFunction</a> = @now</td></tr>
<tr class="memdesc:ae0d4db102f0f75fa28303e4701c493c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">function handle for getting the current date-and-time as a number <br /></td></tr>
<tr class="separator:ae0d4db102f0f75fa28303e4701c493c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44482a28f419b3d6aedc0517f5688b3c"><td class="memItemLeft" align="right" valign="top"><a id="a44482a28f419b3d6aedc0517f5688b3c"></a>
Property&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtops_data_file.html#a44482a28f419b3d6aedc0517f5688b3c">datestrFormat</a> = 'yyyymmddTHHMMSSPFFF'</td></tr>
<tr class="memdesc:a44482a28f419b3d6aedc0517f5688b3c"><td class="mdescLeft">&#160;</td><td class="mdescRight">format string to use with Matlab's builtin datestr() <br /></td></tr>
<tr class="separator:a44482a28f419b3d6aedc0517f5688b3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a817361dc71b486729abecee9dbebd4db"><td class="memItemLeft" align="right" valign="top"><a id="a817361dc71b486729abecee9dbebd4db"></a>
Property&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtops_data_file.html#a817361dc71b486729abecee9dbebd4db">writtenIncrements</a> = []</td></tr>
<tr class="memdesc:a817361dc71b486729abecee9dbebd4db"><td class="mdescLeft">&#160;</td><td class="mdescRight">array of date-and-time numbers for previously written data increments <br /></td></tr>
<tr class="separator:a817361dc71b486729abecee9dbebd4db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43e8bf0a8dfdc6738833447316254395"><td class="memItemLeft" align="right" valign="top"><a id="a43e8bf0a8dfdc6738833447316254395"></a>
Property&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtops_data_file.html#a43e8bf0a8dfdc6738833447316254395">readIncrements</a> = []</td></tr>
<tr class="memdesc:a43e8bf0a8dfdc6738833447316254395"><td class="mdescLeft">&#160;</td><td class="mdescRight">array of date-and-time numbers for previously read data increments <br /></td></tr>
<tr class="separator:a43e8bf0a8dfdc6738833447316254395"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cfc5ba75207a41bfd5c8a88ec2ff7cb"><td class="memItemLeft" align="right" valign="top"><a id="a0cfc5ba75207a41bfd5c8a88ec2ff7cb"></a>
Property&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtops_data_file.html#a0cfc5ba75207a41bfd5c8a88ec2ff7cb">userData</a> = []</td></tr>
<tr class="memdesc:a0cfc5ba75207a41bfd5c8a88ec2ff7cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">any external data to be stored with the header metadata <br /></td></tr>
<tr class="separator:a0cfc5ba75207a41bfd5c8a88ec2ff7cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Methods</h2></td></tr>
<tr class="memitem:a932f7761ec6c24ffbfa78c05ce94bfba"><td class="memItemLeft" align="right" valign="top">static fHeader&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtops_data_file.html#a932f7761ec6c24ffbfa78c05ce94bfba">newHeader</a> (varargin)</td></tr>
<tr class="memdesc:a932f7761ec6c24ffbfa78c05ce94bfba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a header struct with fields that match the properties of the <a class="el" href="classtops_data_file.html" title="Utility to organize incremental reading and writing of data.">topsDataFile</a> class.  <a href="#a932f7761ec6c24ffbfa78c05ce94bfba">More...</a><br /></td></tr>
<tr class="separator:a932f7761ec6c24ffbfa78c05ce94bfba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e42f6b536f6148fb314ce8787e6710c"><td class="memItemLeft" align="right" valign="top">static fHeader incrementCell&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtops_data_file.html#a1e42f6b536f6148fb314ce8787e6710c">read</a> (fHeader, increments)</td></tr>
<tr class="memdesc:a1e42f6b536f6148fb314ce8787e6710c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read any new data increments from a <a class="el" href="classtops_data_file.html" title="Utility to organize incremental reading and writing of data.">topsDataFile</a>.  <a href="#a1e42f6b536f6148fb314ce8787e6710c">More...</a><br /></td></tr>
<tr class="separator:a1e42f6b536f6148fb314ce8787e6710c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c2841b8cc5ac05d5193040fbbe14e8d"><td class="memItemLeft" align="right" valign="top">static fHeader&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtops_data_file.html#a9c2841b8cc5ac05d5193040fbbe14e8d">write</a> (fHeader, newIncrement)</td></tr>
<tr class="memdesc:a9c2841b8cc5ac05d5193040fbbe14e8d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write a new data increment to a <a class="el" href="classtops_data_file.html" title="Utility to organize incremental reading and writing of data.">topsDataFile</a>.  <a href="#a9c2841b8cc5ac05d5193040fbbe14e8d">More...</a><br /></td></tr>
<tr class="separator:a9c2841b8cc5ac05d5193040fbbe14e8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b0ac9371b6f7954a78cf50cf63f1351"><td class="memItemLeft" align="right" valign="top"><a id="a2b0ac9371b6f7954a78cf50cf63f1351"></a>
static names&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtops_data_file.html#a2b0ac9371b6f7954a78cf50cf63f1351">incrementNamesFromNumbers</a> (fHeader, numbers)</td></tr>
<tr class="memdesc:a2b0ac9371b6f7954a78cf50cf63f1351"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get data increment names from date-and-time numbers. <br /></td></tr>
<tr class="separator:a2b0ac9371b6f7954a78cf50cf63f1351"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Methods</h2></td></tr>
<tr class="memitem:a9e3951a51716ccce14d66057d18283bd"><td class="memItemLeft" align="right" valign="top"><a id="a9e3951a51716ccce14d66057d18283bd"></a>
fHeader&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtops_data_file.html#a9e3951a51716ccce14d66057d18283bd">toStruct</a> (fObj)</td></tr>
<tr class="memdesc:a9e3951a51716ccce14d66057d18283bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert a <a class="el" href="classtops_data_file.html" title="Utility to organize incremental reading and writing of data.">topsDataFile</a> object to an equivalent struct. <br /></td></tr>
<tr class="separator:a9e3951a51716ccce14d66057d18283bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Methods</h2>
<a id="a932f7761ec6c24ffbfa78c05ce94bfba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a932f7761ec6c24ffbfa78c05ce94bfba">&#9670;&nbsp;</a></span>newHeader()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static fHeader newHeader </td>
          <td>(</td>
          <td class="paramtype">varargin&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create a header struct with fields that match the properties of the <a class="el" href="classtops_data_file.html" title="Utility to organize incremental reading and writing of data.">topsDataFile</a> class. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">varargin</td><td>optional property-value pairs to assign to the new header.</td></tr>
  </table>
  </dd>
</dl>
<p>Use this method instead of the <a class="el" href="classtops_data_file.html" title="Utility to organize incremental reading and writing of data.">topsDataFile</a> constructor.</p>
<p>Returns a header struct with fields and default values that match those of the <a class="el" href="classtops_data_file.html" title="Utility to organize incremental reading and writing of data.">topsDataFile</a> class. <em>varargin</em> may contain pairs of property names and values to be assigned to the new struct. </p>

</div>
</div>
<a id="a1e42f6b536f6148fb314ce8787e6710c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e42f6b536f6148fb314ce8787e6710c">&#9670;&nbsp;</a></span>read()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static fHeader incrementCell read </td>
          <td>(</td>
          <td class="paramtype">fHeader&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">increments&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Read any new data increments from a <a class="el" href="classtops_data_file.html" title="Utility to organize incremental reading and writing of data.">topsDataFile</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fHeader</td><td>a <a class="el" href="classtops_data_file.html" title="Utility to organize incremental reading and writing of data.">topsDataFile</a> header struct as returned from <a class="el" href="classtops_data_file.html#a932f7761ec6c24ffbfa78c05ce94bfba" title="Create a header struct with fields that match the properties of the topsDataFile class.">newHeader()</a>. </td></tr>
    <tr><td class="paramname">increments</td><td>optional array of date-and-time numbers identifying data increments to read or re-read from the <a class="el" href="classtops_data_file.html" title="Utility to organize incremental reading and writing of data.">topsDataFile</a></td></tr>
  </table>
  </dd>
</dl>
<p>Uses <em>fHeader</em> to locate a <a class="el" href="classtops_data_file.html" title="Utility to organize incremental reading and writing of data.">topsDataFile</a> on disk. If the file exists and contains <a class="el" href="classtops_data_file.html" title="Utility to organize incremental reading and writing of data.">topsDataFile</a> header metadata, loads the metadata from disk and updates <em>fHeader</em> to match. Returns the updated <em>fHeader</em> </p>
<p>Also returns a cell array containing any data increments that have not yet been read from disk. These increments correspond to values in <em>fHeader.writtenIncrements</em> that are not yet present in <em>fHeader.readIncrements</em>.</p>
<p>If <em>increments</em> is provided, attempts to read or re-read the specified data increments from the <a class="el" href="classtops_data_file.html" title="Utility to organize incremental reading and writing of data.">topsDataFile</a>. Returns a cell array with the same size as <em>increments</em>. Where the specified <em>increments</em> are not present in the <a class="el" href="classtops_data_file.html" title="Utility to organize incremental reading and writing of data.">topsDataFile</a>, the returned cell array will be empty. Using <a class="el" href="classtops_data_file.html#a1e42f6b536f6148fb314ce8787e6710c" title="Read any new data increments from a topsDataFile.">read()</a> in this way will not affect <em>fHeader.readIncrements</em>, or subsequent calls to <a class="el" href="classtops_data_file.html#a1e42f6b536f6148fb314ce8787e6710c" title="Read any new data increments from a topsDataFile.">read()</a>. </p>

</div>
</div>
<a id="a9c2841b8cc5ac05d5193040fbbe14e8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c2841b8cc5ac05d5193040fbbe14e8d">&#9670;&nbsp;</a></span>write()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static fHeader write </td>
          <td>(</td>
          <td class="paramtype">fHeader&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">newIncrement&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Write a new data increment to a <a class="el" href="classtops_data_file.html" title="Utility to organize incremental reading and writing of data.">topsDataFile</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fHeader</td><td>a <a class="el" href="classtops_data_file.html" title="Utility to organize incremental reading and writing of data.">topsDataFile</a> header struct as returned from <a class="el" href="classtops_data_file.html#a932f7761ec6c24ffbfa78c05ce94bfba" title="Create a header struct with fields that match the properties of the topsDataFile class.">newHeader()</a>. </td></tr>
    <tr><td class="paramname">newIncrement</td><td>any data increment to append to the <a class="el" href="classtops_data_file.html" title="Utility to organize incremental reading and writing of data.">topsDataFile</a></td></tr>
  </table>
  </dd>
</dl>
<p>If <em>newIncrement</em> is provided, appends the <em>newIncrement</em> to the <a class="el" href="classtops_data_file.html" title="Utility to organize incremental reading and writing of data.">topsDataFile</a> on disk, then updates the hjeader metadata on disk. If a@ newIncrement is omitted, only writes header metadata to disk. If the <a class="el" href="classtops_data_file.html" title="Utility to organize incremental reading and writing of data.">topsDataFile</a> doesn't already exist on disk, creates the new file first.</p>
<p>Since <a class="el" href="classtops_data_file.html#a9c2841b8cc5ac05d5193040fbbe14e8d" title="Write a new data increment to a topsDataFile.">write()</a> updates header metadata only after writing the new increment data, concurrent <a class="el" href="classtops_data_file.html#a1e42f6b536f6148fb314ce8787e6710c" title="Read any new data increments from a topsDataFile.">read()</a> calls, such as from a separate Matlab instance, should be able to safely ignore increment data that's in the process of being written.</p>
<p>Returns <em>fHeader</em>, which may have been modified with new metadata. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>topsDataFile.m</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
